{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\negis\\\\OneDrive\\\\Desktop\\\\new project\\\\blockfest-ui\\\\src\\\\pages\\\\AdminDashboard.tsx\",\n  _s = $RefreshSig$();\n// src/pages/AdminDashboard.tsx\n\nimport { useState, useEffect } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { useAuth } from '../contexts/AuthContext';\nimport { uploadVipCsvApi, getAllTicketsApi } from '../firebase/index';\nimport GlowingButton from '../components/GlowingButton';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst AdminDashboard = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [uploading, setUploading] = useState(false);\n  const [vipFile, setVipFile] = useState(null);\n  const [storedFileInfo, setStoredFileInfo] = useState(null);\n  const [allTickets, setAllTickets] = useState([]);\n  const [loadingTickets, setLoadingTickets] = useState(false);\n\n  // Admin Data Button States\n  const [isDataFetched, setIsDataFetched] = useState(false);\n  const [isFetching, setIsFetching] = useState(false);\n\n  // Load stored file info and admin data from sessionStorage on component mount\n  useEffect(() => {\n    const storedInfo = sessionStorage.getItem('vipFileInfo');\n    if (storedInfo) {\n      setStoredFileInfo(JSON.parse(storedInfo));\n\n      // Recreate the File object from stored data\n      retrieveStoredFile();\n    }\n    const storedData = sessionStorage.getItem('blockfestAdminData');\n    if (storedData) {\n      setIsDataFetched(true);\n    }\n  }, []);\n\n  // Retrieve the file from session storage and convert back to a File object\n  const retrieveStoredFile = async () => {\n    const storedInfo = sessionStorage.getItem('vipFileInfo');\n    if (!storedInfo) return;\n    const fileInfo = JSON.parse(storedInfo);\n    try {\n      // Convert base64 to blob\n      const response = await fetch(fileInfo.content);\n      const blob = await response.blob();\n\n      // Create a new File object\n      const file = new File([blob], fileInfo.name, {\n        type: fileInfo.type,\n        lastModified: fileInfo.lastModified\n      });\n      setVipFile(file);\n      toast.success('Restored previously selected file');\n    } catch (error) {\n      console.error(\"Error retrieving stored file:\", error);\n      toast.error(\"Couldn't restore the previously selected file\");\n      clearStoredFile();\n    }\n  };\n  const handleFileChange = async e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (file) {\n      setVipFile(file);\n      try {\n        // Convert file to base64 for storage\n        const base64 = await convertFileToBase64(file);\n\n        // Store file info and content in sessionStorage\n        const fileInfo = {\n          name: file.name,\n          size: file.size,\n          type: file.type,\n          lastModified: file.lastModified,\n          content: base64\n        };\n        sessionStorage.setItem('vipFileInfo', JSON.stringify(fileInfo));\n        setStoredFileInfo(fileInfo);\n        toast.success(`File \"${file.name}\" stored in session`);\n      } catch (error) {\n        console.error(\"Error storing file:\", error);\n        toast.error(\"Failed to store file in session\");\n      }\n    }\n  };\n\n  // Helper function to convert File to base64\n  const convertFileToBase64 = file => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = error => reject(error);\n    });\n  };\n  const handleUploadVIPList = async () => {\n    if (!vipFile) {\n      // Try to use stored file info to inform the user\n      if (storedFileInfo) {\n        toast.error(`Please select a file again. The file \"${storedFileInfo.name}\" is no longer available.`);\n        // Clear stored file info\n        sessionStorage.removeItem('vipFileInfo');\n        setStoredFileInfo(null);\n      } else {\n        toast.error(\"Please select a CSV file.\");\n      }\n      return;\n    }\n    setUploading(true);\n    toast.loading('Uploading VIP list...', {\n      id: 'vip-upload'\n    });\n    try {\n      const response = await uploadVipCsvApi(vipFile);\n      toast.success(`Upload successful! Processed: ${response.processedCount}, Errors: ${response.errorCount}`, {\n        id: 'vip-upload',\n        duration: 5000\n      });\n\n      // Mark that the file has been uploaded successfully\n      if (storedFileInfo) {\n        const updatedFileInfo = {\n          ...storedFileInfo,\n          uploaded: true,\n          uploadedAt: new Date().toISOString()\n        };\n        sessionStorage.setItem('vipFileInfo', JSON.stringify(updatedFileInfo));\n        setStoredFileInfo(updatedFileInfo);\n      }\n\n      // Keep the file in state for potential reuse\n      // Don't clear the file input or state after successful upload\n    } catch (error) {\n      console.error(\"VIP Upload Failed:\", error);\n      toast.error(`Upload Failed: ${error.message}`, {\n        id: 'vip-upload'\n      });\n    } finally {\n      setUploading(false);\n    }\n  };\n  const handleViewAllTickets = async () => {\n    setLoadingTickets(true);\n    setAllTickets([]);\n    toast.loading(\"Fetching all minted tickets...\", {\n      id: 'fetch-tickets'\n    });\n    try {\n      const tickets = await getAllTicketsApi();\n      setAllTickets(tickets);\n      toast.success(`Loaded ${tickets.length} tickets.`, {\n        id: 'fetch-tickets'\n      });\n    } catch (error) {\n      console.error(\"Fetch All Tickets Failed:\", error);\n      toast.error(`Failed: ${error.message}`, {\n        id: 'fetch-tickets'\n      });\n    } finally {\n      setLoadingTickets(false);\n    }\n  };\n  const clearStoredFile = () => {\n    sessionStorage.removeItem('vipFileInfo');\n    setStoredFileInfo(null);\n    setVipFile(null);\n    const input = document.getElementById('vip-file-input');\n    if (input) input.value = '';\n    toast.success('File information cleared.');\n  };\n\n  // Admin Data Button Functions\n  const fetchAndStoreData = async () => {\n    setIsFetching(true);\n    toast.loading('Fetching admin data...', {\n      id: 'admin-data-fetch'\n    });\n    try {\n      // This is where you would make your actual API calls to fetch VIP list and ticket data\n      // For example:\n      // const vipList = await getVipListApi();\n      // const ticketStats = await getTicketStatsApi();\n\n      // Simulate API call with timeout\n      await new Promise(resolve => setTimeout(resolve, 1500));\n\n      // Sample data - replace with your actual API response\n      const data = {\n        vipList: [{\n          id: 1,\n          name: 'VIP Member 1',\n          email: 'vip1@example.com',\n          wallet: '0x123...456'\n        }, {\n          id: 2,\n          name: 'VIP Member 2',\n          email: 'vip2@example.com',\n          wallet: '0x789...012'\n        }],\n        ticketStats: {\n          total: 250,\n          claimed: 187,\n          remaining: 63\n        },\n        lastFetched: new Date().toISOString()\n      };\n\n      // Store in sessionStorage to persist between page navigations\n      sessionStorage.setItem('blockfestAdminData', JSON.stringify(data));\n      setIsDataFetched(true);\n      toast.success('Admin data fetched and stored successfully', {\n        id: 'admin-data-fetch'\n      });\n    } catch (err) {\n      console.error('Admin data fetch error:', err);\n      toast.error(`Failed to fetch data: ${err.message || 'Unknown error'}`, {\n        id: 'admin-data-fetch'\n      });\n    } finally {\n      setIsFetching(false);\n    }\n  };\n  const clearStoredData = () => {\n    sessionStorage.removeItem('blockfestAdminData');\n    setIsDataFetched(false);\n    toast.success('Admin data cleared');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"text-3xl font-bold text-accent-light\",\n      children: \"Admin Dashboard\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 13\n    }, this), user && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-text-secondary mb-6\",\n      children: [\"Welcome, Admin \", user.email, \"!\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 22\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"bg-secondary-dark p-6 rounded-lg shadow-lg border border-accent-glow/20\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold text-text-main mb-4\",\n        children: \"Admin Session Data\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 17\n      }, this), isDataFetched ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-3 h-3 bg-accent-glow rounded-full mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-accent-light font-medium\",\n            children: \"Data loaded and stored in session\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-text-secondary\",\n          children: \"VIP list and ticket data is stored in your session and will persist until you logout.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(GlowingButton, {\n            onClick: fetchAndStoreData,\n            disabled: isFetching,\n            children: isFetching ? 'Refreshing...' : 'Refresh Data'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: clearStoredData,\n            className: \"px-4 py-2 bg-secondary-light text-text-main rounded hover:bg-secondary-light/80 transition-colors\",\n            children: \"Clear Data\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-text-secondary\",\n          children: \"Fetch your admin data to keep it accessible while you navigate through different pages.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(GlowingButton, {\n          onClick: fetchAndStoreData,\n          disabled: isFetching,\n          children: isFetching ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"inline-block mr-2 animate-spin\",\n              children: \"\\u27F3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 37\n            }, this), \"Fetching Data...\"]\n          }, void 0, true) : 'Fetch and Store Admin Data'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-text-secondary text-sm mt-2\",\n          children: \"Data will be available until you logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"bg-secondary-dark p-6 rounded-lg shadow-lg border border-accent-glow/20\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold text-text-main mb-4\",\n        children: \"Upload VIP List\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"vip-file-input\",\n          type: \"file\",\n          accept: \".csv\",\n          onChange: handleFileChange,\n          className: \"mb-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 21\n        }, this), storedFileInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center mb-4 text-text-secondary\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [storedFileInfo.uploaded ? '✓ ' : '', \"File selected: \", storedFileInfo.name, storedFileInfo.uploaded && ' (Uploaded)']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"ml-2 text-accent-light hover:text-accent-glow\",\n            onClick: clearStoredFile,\n            children: \"\\u2715\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(GlowingButton, {\n            onClick: handleUploadVIPList,\n            disabled: !vipFile || uploading,\n            children: uploading ? 'Uploading...' : storedFileInfo !== null && storedFileInfo !== void 0 && storedFileInfo.uploaded ? 'Upload Again' : 'Upload CSV'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 25\n          }, this), !vipFile && !storedFileInfo && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-text-secondary italic\",\n            children: \"Please select a CSV file\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"bg-secondary-dark p-6 rounded-lg shadow-lg border border-accent-glow/20\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-semibold text-text-main mb-4\",\n        children: \"View All Issued Tickets\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(GlowingButton, {\n        onClick: handleViewAllTickets,\n        disabled: loadingTickets,\n        children: loadingTickets ? 'Loading...' : 'Fetch All Tickets'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 17\n      }, this), loadingTickets && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-text-secondary mt-4\",\n        children: \"Loading ticket data...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 36\n      }, this), !loadingTickets && allTickets.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-6 overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"table\", {\n          className: \"min-w-full divide-y divide-accent-glow/20 text-left text-sm\",\n          children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n            className: \"bg-primary-dark/50\",\n            children: /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 font-medium text-text-secondary\",\n                children: \"Token ID\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 font-medium text-text-secondary\",\n                children: \"Owner\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 font-medium text-text-secondary\",\n                children: \"Event\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 362,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 font-medium text-text-secondary\",\n                children: \"Seat\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                className: \"px-4 py-2 font-medium text-text-secondary\",\n                children: \"QR Hash\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n            className: \"divide-y divide-secondary-dark\",\n            children: allTickets.map(ticket => /*#__PURE__*/_jsxDEV(\"tr\", {\n              className: \"hover:bg-secondary-dark/50\",\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-text-main\",\n                children: ticket.tokenId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-text-main truncate\",\n                title: ticket.owner,\n                children: `${ticket.owner.substring(0, 6)}...${ticket.owner.substring(ticket.owner.length - 4)}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-text-main\",\n                children: ticket.eventName || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-text-main\",\n                children: ticket.seat || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 375,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                className: \"px-4 py-2 text-text-main truncate\",\n                title: ticket.qrHash,\n                children: ticket.qrHash || 'N/A'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 41\n              }, this)]\n            }, ticket.tokenId, true, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 21\n      }, this), !loadingTickets && allTickets.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-text-secondary mt-4\",\n        children: \"No ticket data loaded. Click fetch to view.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 238,\n    columnNumber: 9\n  }, this);\n};\n_s(AdminDashboard, \"pduKpCgv2fG27EfVwuJB47FjymE=\", false, function () {\n  return [useAuth];\n});\n_c = AdminDashboard;\nexport default AdminDashboard;\nvar _c;\n$RefreshReg$(_c, \"AdminDashboard\");","map":{"version":3,"names":["useState","useEffect","toast","useAuth","uploadVipCsvApi","getAllTicketsApi","GlowingButton","jsxDEV","_jsxDEV","Fragment","_Fragment","AdminDashboard","_s","user","uploading","setUploading","vipFile","setVipFile","storedFileInfo","setStoredFileInfo","allTickets","setAllTickets","loadingTickets","setLoadingTickets","isDataFetched","setIsDataFetched","isFetching","setIsFetching","storedInfo","sessionStorage","getItem","JSON","parse","retrieveStoredFile","storedData","fileInfo","response","fetch","content","blob","file","File","name","type","lastModified","success","error","console","clearStoredFile","handleFileChange","e","_e$target$files","target","files","base64","convertFileToBase64","size","setItem","stringify","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","handleUploadVIPList","removeItem","loading","id","processedCount","errorCount","duration","updatedFileInfo","uploaded","uploadedAt","Date","toISOString","message","handleViewAllTickets","tickets","length","input","document","getElementById","value","fetchAndStoreData","setTimeout","data","vipList","email","wallet","ticketStats","total","claimed","remaining","lastFetched","err","clearStoredData","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","accept","onChange","map","ticket","tokenId","title","owner","substring","eventName","seat","qrHash","_c","$RefreshReg$"],"sources":["C:/Users/negis/OneDrive/Desktop/new project/blockfest-ui/src/pages/AdminDashboard.tsx"],"sourcesContent":["// src/pages/AdminDashboard.tsx\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { toast } from 'react-hot-toast';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport { uploadVipCsvApi, getAllTicketsApi, TicketData } from '../firebase/index';\r\nimport GlowingButton from '../components/GlowingButton';\r\n\r\ninterface StoredFileInfo {\r\n  name: string;\r\n  size: number;\r\n  type: string;\r\n  lastModified: number;\r\n  content: string; // Base64 encoded file content\r\n  uploaded?: boolean;\r\n  uploadedAt?: string;\r\n}\r\n\r\ninterface AdminDataState {\r\n  vipList: Array<any>;\r\n  ticketStats: {\r\n    total: number;\r\n    claimed: number;\r\n    remaining: number;\r\n  };\r\n  lastFetched: string;\r\n}\r\n\r\nconst AdminDashboard: React.FC = () => {\r\n    const { user } = useAuth();\r\n    const [uploading, setUploading] = useState(false);\r\n    const [vipFile, setVipFile] = useState<File | null>(null);\r\n    const [storedFileInfo, setStoredFileInfo] = useState<StoredFileInfo | null>(null);\r\n    const [allTickets, setAllTickets] = useState<TicketData[]>([]);\r\n    const [loadingTickets, setLoadingTickets] = useState(false);\r\n    \r\n    // Admin Data Button States\r\n    const [isDataFetched, setIsDataFetched] = useState(false);\r\n    const [isFetching, setIsFetching] = useState(false);\r\n\r\n    // Load stored file info and admin data from sessionStorage on component mount\r\n    useEffect(() => {\r\n        const storedInfo = sessionStorage.getItem('vipFileInfo');\r\n        if (storedInfo) {\r\n            setStoredFileInfo(JSON.parse(storedInfo));\r\n            \r\n            // Recreate the File object from stored data\r\n            retrieveStoredFile();\r\n        }\r\n        \r\n        const storedData = sessionStorage.getItem('blockfestAdminData');\r\n        if (storedData) {\r\n            setIsDataFetched(true);\r\n        }\r\n    }, []);\r\n\r\n    // Retrieve the file from session storage and convert back to a File object\r\n    const retrieveStoredFile = async () => {\r\n        const storedInfo = sessionStorage.getItem('vipFileInfo');\r\n        if (!storedInfo) return;\r\n        \r\n        const fileInfo: StoredFileInfo = JSON.parse(storedInfo);\r\n        \r\n        try {\r\n            // Convert base64 to blob\r\n            const response = await fetch(fileInfo.content);\r\n            const blob = await response.blob();\r\n            \r\n            // Create a new File object\r\n            const file = new File([blob], fileInfo.name, {\r\n                type: fileInfo.type,\r\n                lastModified: fileInfo.lastModified\r\n            });\r\n            \r\n            setVipFile(file);\r\n            toast.success('Restored previously selected file');\r\n        } catch (error) {\r\n            console.error(\"Error retrieving stored file:\", error);\r\n            toast.error(\"Couldn't restore the previously selected file\");\r\n            clearStoredFile();\r\n        }\r\n    };\r\n\r\n    const handleFileChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            setVipFile(file);\r\n            \r\n            try {\r\n                // Convert file to base64 for storage\r\n                const base64 = await convertFileToBase64(file);\r\n                \r\n                // Store file info and content in sessionStorage\r\n                const fileInfo: StoredFileInfo = {\r\n                    name: file.name,\r\n                    size: file.size,\r\n                    type: file.type,\r\n                    lastModified: file.lastModified,\r\n                    content: base64\r\n                };\r\n                \r\n                sessionStorage.setItem('vipFileInfo', JSON.stringify(fileInfo));\r\n                setStoredFileInfo(fileInfo);\r\n                toast.success(`File \"${file.name}\" stored in session`);\r\n            } catch (error) {\r\n                console.error(\"Error storing file:\", error);\r\n                toast.error(\"Failed to store file in session\");\r\n            }\r\n        }\r\n    };\r\n\r\n    // Helper function to convert File to base64\r\n    const convertFileToBase64 = (file: File): Promise<string> => {\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.readAsDataURL(file);\r\n            reader.onload = () => resolve(reader.result as string);\r\n            reader.onerror = error => reject(error);\r\n        });\r\n    };\r\n\r\n    const handleUploadVIPList = async () => {\r\n        if (!vipFile) {\r\n            // Try to use stored file info to inform the user\r\n            if (storedFileInfo) {\r\n                toast.error(`Please select a file again. The file \"${storedFileInfo.name}\" is no longer available.`);\r\n                // Clear stored file info\r\n                sessionStorage.removeItem('vipFileInfo');\r\n                setStoredFileInfo(null);\r\n            } else {\r\n                toast.error(\"Please select a CSV file.\");\r\n            }\r\n            return;\r\n        }\r\n\r\n        setUploading(true);\r\n        toast.loading('Uploading VIP list...', { id: 'vip-upload' });\r\n        try {\r\n            const response = await uploadVipCsvApi(vipFile);\r\n            toast.success(`Upload successful! Processed: ${response.processedCount}, Errors: ${response.errorCount}`, { \r\n                id: 'vip-upload', \r\n                duration: 5000 \r\n            });\r\n            \r\n            // Mark that the file has been uploaded successfully\r\n            if (storedFileInfo) {\r\n                const updatedFileInfo = {\r\n                    ...storedFileInfo,\r\n                    uploaded: true,\r\n                    uploadedAt: new Date().toISOString()\r\n                };\r\n                sessionStorage.setItem('vipFileInfo', JSON.stringify(updatedFileInfo));\r\n                setStoredFileInfo(updatedFileInfo);\r\n            }\r\n            \r\n            // Keep the file in state for potential reuse\r\n            // Don't clear the file input or state after successful upload\r\n        } catch (error: any) {\r\n            console.error(\"VIP Upload Failed:\", error);\r\n            toast.error(`Upload Failed: ${error.message}`, { id: 'vip-upload' });\r\n        } finally {\r\n            setUploading(false);\r\n        }\r\n    };\r\n\r\n    const handleViewAllTickets = async () => {\r\n        setLoadingTickets(true);\r\n        setAllTickets([]);\r\n        toast.loading(\"Fetching all minted tickets...\", { id: 'fetch-tickets' });\r\n        try {\r\n            const tickets = await getAllTicketsApi();\r\n            setAllTickets(tickets);\r\n            toast.success(`Loaded ${tickets.length} tickets.`, { id: 'fetch-tickets' });\r\n        } catch (error: any) {\r\n            console.error(\"Fetch All Tickets Failed:\", error);\r\n            toast.error(`Failed: ${error.message}`, { id: 'fetch-tickets' });\r\n        } finally {\r\n            setLoadingTickets(false);\r\n        }\r\n    };\r\n\r\n    const clearStoredFile = () => {\r\n        sessionStorage.removeItem('vipFileInfo');\r\n        setStoredFileInfo(null);\r\n        setVipFile(null);\r\n        const input = document.getElementById('vip-file-input') as HTMLInputElement;\r\n        if (input) input.value = '';\r\n        toast.success('File information cleared.');\r\n    };\r\n\r\n    // Admin Data Button Functions\r\n    const fetchAndStoreData = async () => {\r\n        setIsFetching(true);\r\n        toast.loading('Fetching admin data...', { id: 'admin-data-fetch' });\r\n        \r\n        try {\r\n            // This is where you would make your actual API calls to fetch VIP list and ticket data\r\n            // For example:\r\n            // const vipList = await getVipListApi();\r\n            // const ticketStats = await getTicketStatsApi();\r\n            \r\n            // Simulate API call with timeout\r\n            await new Promise(resolve => setTimeout(resolve, 1500));\r\n            \r\n            // Sample data - replace with your actual API response\r\n            const data: AdminDataState = {\r\n                vipList: [\r\n                    { id: 1, name: 'VIP Member 1', email: 'vip1@example.com', wallet: '0x123...456' },\r\n                    { id: 2, name: 'VIP Member 2', email: 'vip2@example.com', wallet: '0x789...012' },\r\n                ],\r\n                ticketStats: {\r\n                    total: 250,\r\n                    claimed: 187,\r\n                    remaining: 63\r\n                },\r\n                lastFetched: new Date().toISOString()\r\n            };\r\n            \r\n            // Store in sessionStorage to persist between page navigations\r\n            sessionStorage.setItem('blockfestAdminData', JSON.stringify(data));\r\n            setIsDataFetched(true);\r\n            toast.success('Admin data fetched and stored successfully', { id: 'admin-data-fetch' });\r\n        } catch (err: any) {\r\n            console.error('Admin data fetch error:', err);\r\n            toast.error(`Failed to fetch data: ${err.message || 'Unknown error'}`, { id: 'admin-data-fetch' });\r\n        } finally {\r\n            setIsFetching(false);\r\n        }\r\n    };\r\n\r\n    const clearStoredData = () => {\r\n        sessionStorage.removeItem('blockfestAdminData');\r\n        setIsDataFetched(false);\r\n        toast.success('Admin data cleared');\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-8\">\r\n            <h1 className=\"text-3xl font-bold text-accent-light\">Admin Dashboard</h1>\r\n            {user && <p className='text-text-secondary mb-6'>Welcome, Admin {user.email}!</p>}\r\n\r\n            {/* Admin Data Button Section */}\r\n            <section className=\"bg-secondary-dark p-6 rounded-lg shadow-lg border border-accent-glow/20\">\r\n                <h2 className=\"text-xl font-semibold text-text-main mb-4\">Admin Session Data</h2>\r\n                \r\n                {isDataFetched ? (\r\n                    <div className=\"space-y-4\">\r\n                        <div className=\"flex items-center mb-2\">\r\n                            <div className=\"w-3 h-3 bg-accent-glow rounded-full mr-2\"></div>\r\n                            <span className=\"text-accent-light font-medium\">Data loaded and stored in session</span>\r\n                        </div>\r\n                        \r\n                        <p className=\"text-text-secondary\">\r\n                            VIP list and ticket data is stored in your session and will persist until you logout.\r\n                        </p>\r\n                        \r\n                        <div className=\"flex space-x-4\">\r\n                            <GlowingButton \r\n                                onClick={fetchAndStoreData}\r\n                                disabled={isFetching}\r\n                            >\r\n                                {isFetching ? 'Refreshing...' : 'Refresh Data'}\r\n                            </GlowingButton>\r\n                            \r\n                            <button \r\n                                onClick={clearStoredData}\r\n                                className=\"px-4 py-2 bg-secondary-light text-text-main rounded hover:bg-secondary-light/80 transition-colors\"\r\n                            >\r\n                                Clear Data\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"space-y-4\">\r\n                        <p className=\"text-text-secondary\">\r\n                            Fetch your admin data to keep it accessible while you navigate through different pages.\r\n                        </p>\r\n                        \r\n                        <GlowingButton \r\n                            onClick={fetchAndStoreData}\r\n                            disabled={isFetching}\r\n                        >\r\n                            {isFetching ? (\r\n                                <>\r\n                                    <span className=\"inline-block mr-2 animate-spin\">⟳</span>\r\n                                    Fetching Data...\r\n                                </>\r\n                            ) : (\r\n                                'Fetch and Store Admin Data'\r\n                            )}\r\n                        </GlowingButton>\r\n                        \r\n                        <p className=\"text-text-secondary text-sm mt-2\">\r\n                            Data will be available until you logout\r\n                        </p>\r\n                    </div>\r\n                )}\r\n            </section>\r\n\r\n            {/* VIP Upload Section */}\r\n            <section className=\"bg-secondary-dark p-6 rounded-lg shadow-lg border border-accent-glow/20\">\r\n                <h2 className=\"text-xl font-semibold text-text-main mb-4\">Upload VIP List</h2>\r\n                <div className=\"flex flex-col space-y-2\">\r\n                    <input\r\n                        id=\"vip-file-input\"\r\n                        type=\"file\"\r\n                        accept=\".csv\"\r\n                        onChange={handleFileChange}\r\n                        className=\"mb-2\"\r\n                    />\r\n                    \r\n                    {/* Show stored file info if available */}\r\n                    {storedFileInfo && (\r\n                        <div className=\"flex items-center mb-4 text-text-secondary\">\r\n                            <span>\r\n                                {storedFileInfo.uploaded ? '✓ ' : ''}\r\n                                File selected: {storedFileInfo.name}\r\n                                {storedFileInfo.uploaded && ' (Uploaded)'}\r\n                            </span>\r\n                            <button \r\n                                className=\"ml-2 text-accent-light hover:text-accent-glow\"\r\n                                onClick={clearStoredFile}\r\n                            >\r\n                                ✕\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    <div className=\"flex space-x-4\">\r\n                        <GlowingButton \r\n                            onClick={handleUploadVIPList} \r\n                            disabled={!vipFile || uploading}\r\n                        >\r\n                            {uploading ? 'Uploading...' : storedFileInfo?.uploaded ? 'Upload Again' : 'Upload CSV'}\r\n                        </GlowingButton>\r\n                        \r\n                        {(!vipFile && !storedFileInfo) && (\r\n                            <p className=\"text-text-secondary italic\">\r\n                                Please select a CSV file\r\n                            </p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Ticket Viewing Section */}\r\n            <section className=\"bg-secondary-dark p-6 rounded-lg shadow-lg border border-accent-glow/20\">\r\n                <h2 className=\"text-xl font-semibold text-text-main mb-4\">View All Issued Tickets</h2>\r\n                <GlowingButton onClick={handleViewAllTickets} disabled={loadingTickets}>\r\n                    {loadingTickets ? 'Loading...' : 'Fetch All Tickets'}\r\n                </GlowingButton>\r\n\r\n                {loadingTickets && <p className=\"text-text-secondary mt-4\">Loading ticket data...</p>}\r\n                \r\n                {!loadingTickets && allTickets.length > 0 && (\r\n                    <div className=\"mt-6 overflow-x-auto\">\r\n                        <table className=\"min-w-full divide-y divide-accent-glow/20 text-left text-sm\">\r\n                            <thead className=\"bg-primary-dark/50\">\r\n                                <tr>\r\n                                    <th className=\"px-4 py-2 font-medium text-text-secondary\">Token ID</th>\r\n                                    <th className=\"px-4 py-2 font-medium text-text-secondary\">Owner</th>\r\n                                    <th className=\"px-4 py-2 font-medium text-text-secondary\">Event</th>\r\n                                    <th className=\"px-4 py-2 font-medium text-text-secondary\">Seat</th>\r\n                                    <th className=\"px-4 py-2 font-medium text-text-secondary\">QR Hash</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-secondary-dark\">\r\n                                {allTickets.map((ticket) => (\r\n                                    <tr key={ticket.tokenId} className=\"hover:bg-secondary-dark/50\">\r\n                                        <td className=\"px-4 py-2 text-text-main\">{ticket.tokenId}</td>\r\n                                        <td className=\"px-4 py-2 text-text-main truncate\" title={ticket.owner}>\r\n                                            {`${ticket.owner.substring(0, 6)}...${ticket.owner.substring(ticket.owner.length - 4)}`}\r\n                                        </td>\r\n                                        <td className=\"px-4 py-2 text-text-main\">{ticket.eventName || 'N/A'}</td>\r\n                                        <td className=\"px-4 py-2 text-text-main\">{ticket.seat || 'N/A'}</td>\r\n                                        <td className=\"px-4 py-2 text-text-main truncate\" title={ticket.qrHash}>\r\n                                            {ticket.qrHash || 'N/A'}\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n                \r\n                {!loadingTickets && allTickets.length === 0 && (\r\n                    <p className=\"text-text-secondary mt-4\">No ticket data loaded. Click fetch to view.</p>\r\n                )}\r\n            </section>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AdminDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}